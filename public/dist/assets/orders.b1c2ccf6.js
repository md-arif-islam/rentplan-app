import{S as ae}from"./Table.d473f6a6.js";import{r as s,d as le,c as ne,m as se,a as t,j as n,I as c,F as x,B as b,C as ce,M as v,Q as F}from"./index.075fb68b.js";import{T as f,u as re,M as ie}from"./useCustomTable.fbd3a482.js";import{u as de,a as oe}from"./ordersApiSlice.209ba1fa.js";function ge({title:O="Orders"}){var k;const[r,E]=s.exports.useState(""),[H,d]=s.exports.useState(!1),[o,M]=s.exports.useState(""),[u,N]=s.exports.useState({page:1,perPage:10,search:"",status:""}),m=le(),p=ne(),{data:a,isLoading:A,isError:B,isFetching:L,error:h}=de(u),[j,{isLoading:V}]=oe(),U=e=>{E(e)},I=e=>{M(e.target.value)},Q=e=>{p(v(e)),d(!0)},y=()=>{d(!1),p(v(null))},g=se(e=>e.orders.order),R=async()=>{var e;if(!!g)try{await j(g.id).unwrap(),F.success("Order deleted successfully!"),d(!1),p(v(null))}catch(l){F.error(((e=l==null?void 0:l.data)==null?void 0:e.message)||"Failed to delete order"),console.error(l)}},C=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"\u2014",q=s.exports.useMemo(()=>[{Header:"Customer",accessor:e=>{var l,i;return`${((l=e.customer)==null?void 0:l.first_name)||""} ${((i=e.customer)==null?void 0:i.last_name)||""}`},Cell:({cell:{value:e},row:l})=>t("div",{className:"flex items-center",children:t("span",{children:e.trim()||"\u2014"})})},{Header:"Product",accessor:"product.name",Cell:({cell:{value:e}})=>t("span",{children:e||"\u2014"})},{Header:"Start Date",accessor:"start_date",Cell:({cell:{value:e}})=>t("span",{children:C(e)})},{Header:"End Date",accessor:"end_date",Cell:({cell:{value:e}})=>t("span",{children:C(e)})},{Header:"Status",accessor:"order_status",Cell:e=>{var l,i,_,S,P,D,T,$;return t("span",{className:"block w-full",children:t("span",{className:`inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] text-white ${((l=e==null?void 0:e.cell)==null?void 0:l.value)==="completed"?"bg-success-500":""}
                                ${((i=e==null?void 0:e.cell)==null?void 0:i.value)==="active"?"bg-info-500":""}
                                ${((_=e==null?void 0:e.cell)==null?void 0:_.value)==="pending"?"bg-warning-500":""}
                                ${((S=e==null?void 0:e.cell)==null?void 0:S.value)==="processing"?"bg-primary-500":""}
                                ${((P=e==null?void 0:e.cell)==null?void 0:P.value)==="cancelled"||((D=e==null?void 0:e.cell)==null?void 0:D.value)==="expired"?"bg-danger-500":""}
                                ${["completed","active","pending","processing","cancelled","expired"].includes((T=e==null?void 0:e.cell)==null?void 0:T.value)?"":"bg-slate-500"}
                                `,children:(($=e==null?void 0:e.cell)==null?void 0:$.value)||"Unknown"})})}},{Header:"Action",accessor:"action",Cell:({row:e})=>n("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[t(f,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:t("button",{className:"action-btn",type:"button",onClick:()=>m(`/company/orders/${e.original.id}`),children:t(c,{icon:"heroicons:eye"})})}),t(f,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:t("button",{className:"action-btn",type:"button",onClick:()=>m(`/company/orders/${e.original.id}/edit`),children:t(c,{icon:"heroicons:pencil-square"})})}),t(f,{content:"Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:t("button",{className:"action-btn",type:"button",onClick:()=>Q(e.original),children:t(c,{icon:"heroicons:trash"})})})]})}],[]);s.exports.useEffect(()=>{const e=setTimeout(()=>{N(l=>({...l,page:1,search:r,status:o}))},500);return()=>clearTimeout(e)},[r,o]);const{getTableProps:G,getTableBodyProps:J,headerGroups:K,page:W,prepareRow:X,handlePageSizeChange:Y,handleFirst:Z,handleLast:z,handlePrevious:w,handleNext:ee,renderPaginationButtons:te}=re({dataVar:a,columns:q,pagination:u,setPagination:N});return n(x,{children:[n(ie,{title:"Confirm Delete",labelClass:"btn-outline-danger",themeClass:"bg-danger-500",activeModal:H,onClose:y,centered:!0,footerContent:n("div",{className:"flex items-center gap-3",children:[t(b,{text:"Cancel",className:"btn-outline-dark",onClick:y}),t(b,{text:"Delete",className:"btn-danger",isLoading:V,onClick:R})]}),children:[t("h4",{className:"font-medium text-lg mb-3 text-slate-900",children:"Delete Order"}),t("div",{className:"text-base text-slate-600 dark:text-slate-300",children:g?t(x,{children:"Are you sure you want to delete this order? This action cannot be undone."}):"Are you sure you want to delete this order? This action cannot be undone."})]}),n(ce,{children:[n("div",{className:"md:flex pb-6 items-center",children:[t("h6",{className:"flex-1 md:mb-0 mb-3",children:O}),n("div",{className:"md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",children:[t("input",{type:"text",className:"form-control py-2",placeholder:"Search...",value:r,onChange:e=>U(e.target.value)}),n("select",{className:"form-control py-2 w-auto",value:o,onChange:I,children:[t("option",{value:"",children:"All Status"}),t("option",{value:"pending",children:"Pending"}),t("option",{value:"processing",children:"Processing"}),t("option",{value:"completed",children:"Completed"}),t("option",{value:"cancelled",children:"Cancelled"})]}),t(b,{icon:"heroicons-outline:plus-sm",text:"Add Order",className:"btn-dark font-normal btn-sm",iconClass:"text-lg",onClick:()=>{m("/company/orders/create")}})]})]}),A||L?t(ae,{count:4}):B?n("div",{children:["Error fetching orders:"," ",((k=h==null?void 0:h.data)==null?void 0:k.message)||"Unknown error"]}):n(x,{children:[t("div",{className:"overflow-x-auto -mx-6",children:t("div",{className:"inline-block min-w-full align-middle",children:t("div",{className:"overflow-hidden",children:a&&a.data.length>0?n("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...G(),children:[t("thead",{className:"bg-slate-200 dark:bg-slate-700",children:K.map(e=>s.exports.createElement("tr",{...e.getHeaderGroupProps(),key:e.id},e.headers.map(l=>s.exports.createElement("th",{...l.getHeaderProps(l.getSortByToggleProps()),scope:"col",className:"table-th",key:l.id},l.render("Header"),t("span",{children:l.isSorted?l.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})))))}),t("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...J(),children:W.map(e=>(X(e),s.exports.createElement("tr",{...e.getRowProps(),key:e.id},e.cells.map(l=>s.exports.createElement("td",{...l.getCellProps(),className:"table-td",key:l.column.id},l.render("Cell"))))))})]}):n("div",{className:"text-center py-10",children:[t(c,{icon:"heroicons-outline:search",className:"inline-block text-4xl text-slate-400 mb-3"}),t("h3",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"No orders found"}),t("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:r?`No results found for "${r}"`:"No orders available yet"})]})})})}),a&&a.data.length>0&&n("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[n("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[t("select",{className:"form-control py-2 w-max",value:u.perPage,onChange:e=>Y(Number(e.target.value)),children:[10,25,50].map(e=>n("option",{value:e,children:["Show ",e]},e))}),n("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",n("span",{children:[a?a.current_page:0," ","of ",a?a.last_page:0]})]})]}),n("ul",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[t("li",{children:t("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:Z,disabled:!(a!=null&&a.prev_page_url),children:t(c,{icon:"heroicons:chevron-double-left-solid"})})}),t("li",{children:t("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:w,disabled:!(a!=null&&a.prev_page_url),children:"Prev"})}),te(),t("li",{children:t("button",{className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",onClick:ee,disabled:!(a!=null&&a.next_page_url),children:"Next"})}),t("li",{children:t("button",{onClick:z,disabled:!(a!=null&&a.next_page_url),className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",children:t(c,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})]})]})}export{ge as default};
