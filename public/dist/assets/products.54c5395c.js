import{S as ee}from"./Table.d473f6a6.js";import{r as s,d as te,c as ae,m as le,j as n,a as e,I as i,F as v,B as N,C as ne,J as k,Q as w}from"./index.075fb68b.js";import{T as C,u as se,M as re}from"./useCustomTable.fbd3a482.js";import{u as ie,a as ce}from"./productsApiSlice.3bd2244e.js";function he({title:T="Products"}){var _;const[c,D]=s.exports.useState(""),[F,m]=s.exports.useState(!1),[u,M]=s.exports.useState(""),[h,P]=s.exports.useState({page:1,perPage:10,search:"",type:""}),p=te(),g=ae(),{data:a,isLoading:E,isError:H,isFetching:$,error:x}=ie(h),[j,{isLoading:V}]=ce(),A=t=>{D(t)},B=t=>{M(t.target.value)},L=t=>{g(k(t)),m(!0)},S=()=>{m(!1),g(k(null))},o=le(t=>t.products.product),I=async()=>{var t;if(!!o)try{await j(o.id).unwrap(),w.success(`Product ${o.name} deleted successfully!`),m(!1),g(k(null))}catch(l){w.error(((t=l==null?void 0:l.data)==null?void 0:t.message)||"Failed to delete product"),console.error(l)}},f=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),U=s.exports.useMemo(()=>[{Header:"Name",accessor:"name",Cell:({cell:{value:t},row:l})=>n("div",{className:"flex items-center",children:[e("div",{className:"h-10 w-10 rounded overflow-hidden mr-3",children:l.original.image_url?e("img",{src:`https://kolster-app.onlinewithyou.nl/${l.original.image_url}`,alt:t,className:"w-full h-full object-cover"}):e("div",{className:"flex items-center justify-center w-full h-full bg-slate-200 dark:bg-slate-700",children:e(i,{icon:"heroicons-outline:photograph"})})}),e("span",{children:t||"\u2014"})]})},{Header:"Type",accessor:"type",Cell:t=>{var l,r;return e("span",{className:"block w-full",children:e("span",{className:`inline-block px-3 min-w-[90px] text-center mx-auto py-1 rounded-[999px] text-white ${((l=t==null?void 0:t.cell)==null?void 0:l.value)===0?"bg-success-500":"bg-primary-500"}`,children:((r=t==null?void 0:t.cell)==null?void 0:r.value)===0?"Simple":"Variable"})})}},{Header:"Price",accessor:"price",Cell:({cell:{value:t},row:l})=>{if(l.original.type===1){const r=l.original.variations||[];if(r.length===0)return e("span",{children:"\u2014"});const d=r.map(z=>parseFloat(z.price)),b=Math.min(...d),y=Math.max(...d);return n("span",{children:[f(b)," -"," ",f(y)]})}return e("span",{children:t?f(t):"\u2014"})}},{Header:"Stock",accessor:"stock",Cell:({cell:{value:t},row:l})=>{if(l.original.type===1){const r=l.original.variations||[];if(r.length===0)return e("span",{children:"0"});const d=r.reduce((b,y)=>b+(y.stock||0),0);return e("span",{children:d})}return e("span",{children:t||"0"})}},{Header:"Action",accessor:"action",Cell:({row:t})=>n("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[e(C,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:e("button",{className:"action-btn",type:"button",onClick:()=>p(`/company/products/${t.original.id}`),children:e(i,{icon:"heroicons:eye"})})}),e(C,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:e("button",{className:"action-btn",type:"button",onClick:()=>p(`/company/products/${t.original.id}/edit`),children:e(i,{icon:"heroicons:pencil-square"})})}),e(C,{content:"Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:e("button",{className:"action-btn",type:"button",onClick:()=>L(t.original),children:e(i,{icon:"heroicons:trash"})})})]})}],[]);s.exports.useEffect(()=>{const t=setTimeout(()=>{P(l=>({...l,page:1,search:c,type:u}))},500);return()=>clearTimeout(t)},[c,u]);const{getTableProps:Q,getTableBodyProps:R,headerGroups:q,page:G,prepareRow:J,handlePageSizeChange:K,handleFirst:O,handleLast:W,handlePrevious:X,handleNext:Y,renderPaginationButtons:Z}=se({dataVar:a,columns:U,pagination:h,setPagination:P});return n(v,{children:[n(re,{title:"Confirm Delete",labelClass:"btn-outline-danger",themeClass:"bg-danger-500",activeModal:F,onClose:S,centered:!0,footerContent:n("div",{className:"flex items-center gap-3",children:[e(N,{text:"Cancel",className:"btn-outline-dark",onClick:S}),e(N,{text:"Delete",className:"btn-danger",isLoading:V,onClick:I})]}),children:[e("h4",{className:"font-medium text-lg mb-3 text-slate-900",children:"Delete Product"}),e("div",{className:"text-base text-slate-600 dark:text-slate-300",children:o?n(v,{children:["Are you sure you want to delete"," ",e("strong",{children:o.name}),"? This action cannot be undone."]}):"Are you sure you want to delete this product? This action cannot be undone."})]}),n(ne,{children:[n("div",{className:"md:flex pb-6 items-center",children:[e("h6",{className:"flex-1 md:mb-0 mb-3",children:T}),n("div",{className:"md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",children:[e("input",{type:"text",className:"form-control py-2",placeholder:"Search...",value:c,onChange:t=>A(t.target.value)}),n("select",{className:"form-control py-2 w-auto",value:u,onChange:B,children:[e("option",{value:"",children:"All Types"}),e("option",{value:"0",children:"Simple"}),e("option",{value:"1",children:"Variable"})]}),e(N,{icon:"heroicons-outline:plus-sm",text:"Add Product",className:"btn-dark font-normal btn-sm",iconClass:"text-lg",onClick:()=>{p("/company/products/create")}})]})]}),E||$?e(ee,{count:4}):H?n("div",{children:["Error fetching products:"," ",((_=x==null?void 0:x.data)==null?void 0:_.message)||"Unknown error"]}):n(v,{children:[e("div",{className:"overflow-x-auto -mx-6",children:e("div",{className:"inline-block min-w-full align-middle",children:e("div",{className:"overflow-hidden",children:a&&a.data.length>0?n("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...Q(),children:[e("thead",{className:"bg-slate-200 dark:bg-slate-700",children:q.map(t=>s.exports.createElement("tr",{...t.getHeaderGroupProps(),key:t.id},t.headers.map(l=>s.exports.createElement("th",{...l.getHeaderProps(l.getSortByToggleProps()),scope:"col",className:"table-th",key:l.id},l.render("Header"),e("span",{children:l.isSorted?l.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})))))}),e("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...R(),children:G.map(t=>(J(t),s.exports.createElement("tr",{...t.getRowProps(),key:t.id},t.cells.map(l=>s.exports.createElement("td",{...l.getCellProps(),className:"table-td",key:l.column.id},l.render("Cell"))))))})]}):n("div",{className:"text-center py-10",children:[e(i,{icon:"heroicons-outline:search",className:"inline-block text-4xl text-slate-400 mb-3"}),e("h3",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"No products found"}),e("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:c?`No results found for "${c}"`:"No products available yet"})]})})})}),a&&a.data.length>0&&n("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[n("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[e("select",{className:"form-control py-2 w-max",value:h.perPage,onChange:t=>K(Number(t.target.value)),children:[10,25,50].map(t=>n("option",{value:t,children:["Show ",t]},t))}),n("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",n("span",{children:[a?a.current_page:0," ","of"," ",a?a.last_page:0]})]})]}),n("ul",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[e("li",{children:e("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:O,disabled:!(a!=null&&a.prev_page_url),children:e(i,{icon:"heroicons:chevron-double-left-solid"})})}),e("li",{children:e("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:X,disabled:!(a!=null&&a.prev_page_url),children:"Prev"})}),Z(),e("li",{children:e("button",{className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",onClick:Y,disabled:!(a!=null&&a.next_page_url),children:"Next"})}),e("li",{children:e("button",{onClick:W,disabled:!(a!=null&&a.next_page_url),className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",children:e(i,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})]})]})}export{he as default};
