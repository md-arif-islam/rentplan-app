import{q as z,d as Q,r as L,a as e,y as J,C as u,j as s,I,B as c,Q as j}from"./index.075fb68b.js";import{S as H}from"./Select.3e0ab40e.js";import{T as n}from"./Textinput.595cc28f.js";import{d as K,b as X}from"./companiesApiSlice.7aa8620f.js";import{c as U,a as r,d as Y,e as D,b as Z,u as ee,o as ae}from"./array.537130ac.js";const te=U().shape({name:r().required("Company name is required").max(255,"Company name cannot exceed 255 characters"),email:r().required("Email is required").email("Please enter a valid email address").max(255,"Email cannot exceed 255 characters"),phone:r().max(20,"Phone cannot exceed 20 characters"),website:r().url("Please enter a valid URL").max(255,"Website URL cannot exceed 255 characters").nullable(),address_line_1:r().max(255,"Address cannot exceed 255 characters").nullable(),address_line_2:r().max(255,"Address cannot exceed 255 characters").nullable(),city:r().max(255,"City cannot exceed 255 characters").nullable(),state:r().max(255,"State cannot exceed 255 characters").nullable(),postal_code:r().max(20,"Postal code cannot exceed 20 characters").nullable(),country:r().max(255,"Country cannot exceed 255 characters").nullable(),plan:U().shape({plan_name:r().required("Plan name is required"),plan_price:Y().required("Plan price is required").min(0,"Price cannot be negative"),plan_status:r().required("Plan status is required").oneOf(["active","inactive","trial","expired"],"Invalid plan status"),plan_start_date:D().required("Start date is required"),plan_expiry_date:D().required("Expiry date is required").min(Z("plan_start_date"),"Expiry date must be after start date")})}),oe=()=>{var E,w,P,S,k,q;const{id:h}=z(),d=Q(),b=L.exports.useRef(null),[A,{isLoading:g}]=K(),{data:t,isLoading:R,isError:$,error:y}=X(h),{register:l,handleSubmit:B,formState:{errors:a,isSubmitting:_},setError:F,setValue:f,watch:v,reset:C}=ee({resolver:ae(te),mode:"onChange"});L.exports.useEffect(()=>{t&&C({name:t.name||"",email:t.email||"",phone:t.phone||"",website:t.website||"",address_line_1:t.address_line_1||"",address_line_2:t.address_line_2||"",city:t.city||"",state:t.state||"",postal_code:t.postal_code||"",country:t.country||"",logo:t.logo||null,plan:t.plan||{plan_name:"Basic",plan_price:0,plan_status:"active",plan_features:["basic_features"],plan_start_date:new Date().toISOString().split("T")[0],plan_expiry_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]}})},[t,C]);const O=async p=>{const m=p.target.files[0];if(m){const o=new FileReader;o.onloadend=()=>{f("logo",o.result)},o.readAsDataURL(m)}},T=()=>{b.current.click()},G=async p=>{var m,o;try{await A({id:h,...p}).unwrap(),j.success("Company updated successfully"),d("/admin/companies")}catch(i){console.error("Update failed",i),(m=i==null?void 0:i.data)!=null&&m.errors?Object.entries(i.data.errors).forEach(([V,W])=>{F(V,{type:"manual",message:W[0]})}):j.error(((o=i==null?void 0:i.data)==null?void 0:o.message)||"Failed to update company")}},x=v("logo"),N=x?x.startsWith("data:")?x:`https://kolster-app.onlinewithyou.nl/${x}`:null,M=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"trial",label:"Trial"},{value:"expired",label:"Expired"}];return R?e(J,{}):$?e(u,{children:s("div",{className:"flex flex-col items-center justify-center h-60",children:[e(I,{icon:"heroicons-outline:exclamation-circle",className:"text-danger-500 text-4xl mb-2"}),e("h3",{className:"text-xl font-medium text-slate-900",children:"Error Loading Data"}),e("p",{className:"text-sm text-slate-600 mt-1 mb-4",children:((E=y==null?void 0:y.data)==null?void 0:E.message)||"Could not load company information"}),e(c,{text:"Back to Companies",icon:"heroicons-outline:arrow-left",className:"btn-primary",onClick:()=>d("/admin/companies")})]})}):s("div",{className:"space-y-5",children:[s("div",{className:"flex flex-wrap justify-between items-center",children:[e("h4",{className:"font-medium lg:text-2xl text-xl capitalize text-slate-900 inline-block ltr:pr-4 rtl:pl-4",children:"Edit Company"}),s("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[e(c,{icon:"heroicons-outline:arrow-left",text:"Back",className:"btn-outline-dark",onClick:()=>d("/admin/companies")}),e(c,{icon:"heroicons-outline:eye",text:"View Details",className:"btn-outline-dark",onClick:()=>d(`/admin/companies/${h}`)})]})]}),s("form",{onSubmit:B(G),children:[e(u,{title:"Company Information",children:s("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(n,{label:"Company Name *",type:"text",placeholder:"Enter company name",register:l,name:"name",error:a.name}),e(n,{label:"Email *",type:"email",placeholder:"Enter company email",register:l,name:"email",error:a.email}),e(n,{label:"Phone",type:"text",placeholder:"Enter phone number",register:l,name:"phone",error:a.phone}),e(n,{label:"Website",type:"url",placeholder:"Enter website URL",register:l,name:"website",error:a.website})]})}),e(u,{title:"Address Information",className:"mt-5",children:s("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(n,{label:"Address Line 1",type:"text",placeholder:"Enter address line 1",register:l,name:"address_line_1",error:a.address_line_1}),e(n,{label:"Address Line 2",type:"text",placeholder:"Enter address line 2",register:l,name:"address_line_2",error:a.address_line_2}),e(n,{label:"City",type:"text",placeholder:"Enter city",register:l,name:"city",error:a.city}),e(n,{label:"State/Province",type:"text",placeholder:"Enter state or province",register:l,name:"state",error:a.state}),e(n,{label:"Postal Code",type:"text",placeholder:"Enter postal code",register:l,name:"postal_code",error:a.postal_code}),e(n,{label:"Country",type:"text",placeholder:"Enter country",register:l,name:"country",error:a.country})]})}),e(u,{title:"Company Logo",className:"mt-5",children:s("div",{className:"flex items-start space-x-4 rtl:space-x-reverse",children:[e("div",{children:N?e("img",{src:N,alt:"Logo Preview",className:"h-20 w-20 object-contain border border-slate-200 rounded-lg bg-slate-50"}):e("div",{className:"h-20 w-20 rounded-lg bg-slate-100 flex items-center justify-center",children:e(I,{icon:"heroicons-outline:office-building",className:"text-3xl text-slate-400"})})}),s("div",{className:"flex-1",children:[e(c,{text:"Change Logo",icon:"heroicons-outline:upload",className:"btn-outline-dark",onClick:T}),e("input",{type:"file",ref:b,className:"hidden",accept:"image/*",onChange:O}),e("p",{className:"text-xs text-slate-500 mt-2",children:"Supported formats: JPG, PNG, GIF (Max size: 2MB)"})]})]})}),e(u,{title:"Plan Information",className:"mt-5",children:s("div",{className:"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-5",children:[e(n,{label:"Plan Name",type:"text",placeholder:"Enter plan name",register:l,name:"plan.plan_name",error:(w=a.plan)==null?void 0:w.plan_name}),e(n,{label:"Price",type:"number",placeholder:"Enter price",register:l,name:"plan.plan_price",step:"0.01",min:"0",error:(P=a.plan)==null?void 0:P.plan_price}),e(H,{label:"Status",options:M,value:v("plan.plan_status"),onChange:p=>f("plan.plan_status",p.target.value),error:(S=a.plan)==null?void 0:S.plan_status}),e(n,{label:"Start Date",type:"date",register:l,name:"plan.plan_start_date",error:(k=a.plan)==null?void 0:k.plan_start_date}),e(n,{label:"Expiry Date",type:"date",register:l,name:"plan.plan_expiry_date",error:(q=a.plan)==null?void 0:q.plan_expiry_date})]})}),s("div",{className:"flex justify-between items-center mt-5",children:[e(c,{type:"button",icon:"heroicons-outline:x",text:"Cancel",className:"btn-outline-dark",onClick:()=>d("/admin/companies")}),e(c,{type:"submit",icon:"heroicons-outline:save",text:"Update Company",className:"btn-dark",isLoading:g||_,disabled:g||_})]})]})]})};export{oe as default};
