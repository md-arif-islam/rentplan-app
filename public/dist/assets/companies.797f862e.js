import{S as U}from"./Table.d473f6a6.js";import{r as s,d as W,c as z,m as J,a,j as l,I as r,F as u,B as g,C as K,z as x,Q as N}from"./index.075fb68b.js";import{T as b,u as O,M as X}from"./useCustomTable.fbd3a482.js";import{u as Y,a as Z}from"./companiesApiSlice.7aa8620f.js";function ne({title:v="Companies"}){var C;const[o,k]=s.exports.useState(""),[w,c]=s.exports.useState(!1),[d,f]=s.exports.useState({page:1,perPage:10,search:""}),m=W(),h=z(),{data:t,isLoading:_,isError:P,isFetching:S,error:p}=Y(d),[D,{isLoading:T}]=Z(),E=e=>{k(e)},H=e=>{h(x(e)),c(!0)},y=()=>{c(!1),h(x(null))},i=J(e=>e.companies.company),M=async()=>{var e;if(!!i)try{await D(i.id).unwrap(),N.success(`Company ${i.name} deleted successfully!`),c(!1),h(x(null))}catch(n){N.error(((e=n==null?void 0:n.data)==null?void 0:e.message)||"Failed to delete company"),console.log(n)}},F=s.exports.useMemo(()=>[{Header:"Name",accessor:"name",Cell:({cell:{value:e}})=>a("span",{children:e||"\u2014"})},{Header:"Email",accessor:"email",Cell:({cell:{value:e}})=>a("span",{children:e||"\u2014"})},{Header:"Phone",accessor:"phone",Cell:({cell:{value:e}})=>a("span",{children:e||"\u2014"})},{Header:"Website",accessor:"website",Cell:({cell:{value:e}})=>e?a("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-primary-500 hover:underline",children:e}):a("span",{children:"\u2014"})},{Header:"Location",accessor:"city",Cell:({row:e})=>a("span",{children:[e.original.city,e.original.country].filter(Boolean).join(", ")||"\u2014"})},{Header:"Action",accessor:"action",Cell:({row:e})=>l("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[a(b,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:a("button",{className:"action-btn",type:"button",onClick:()=>m(`/admin/companies/${e.original.id}`),children:a(r,{icon:"heroicons:eye"})})}),a(b,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:a("button",{className:"action-btn",type:"button",onClick:()=>m(`/admin/companies/${e.original.id}/edit`),children:a(r,{icon:"heroicons:pencil-square"})})}),a(b,{content:"Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:a("button",{className:"action-btn",type:"button",onClick:()=>H(e.original),children:a(r,{icon:"heroicons:trash"})})})]})}],[]);s.exports.useEffect(()=>{const e=setTimeout(()=>{f(n=>({...n,page:1,search:o}))},500);return()=>clearTimeout(e)},[o]);const{getTableProps:B,getTableBodyProps:j,headerGroups:L,page:A,prepareRow:V,handlePageSizeChange:$,handleFirst:I,handleLast:Q,handlePrevious:R,handleNext:q,renderPaginationButtons:G}=O({dataVar:t,columns:F,pagination:d,setPagination:f});return l(u,{children:[l(X,{title:"Confirm Delete",labelClass:"btn-outline-danger",themeClass:"bg-danger-500",activeModal:w,onClose:y,centered:!0,footerContent:l("div",{className:"flex items-center gap-3",children:[a(g,{text:"Cancel",className:"btn-outline-dark",onClick:y}),a(g,{text:"Delete",className:"btn-danger",isLoading:T,onClick:M})]}),children:[a("h4",{className:"font-medium text-lg mb-3 text-slate-900",children:"Delete Company"}),a("div",{className:"text-base text-slate-600 dark:text-slate-300",children:i?l(u,{children:["Are you sure you want to delete"," ",a("strong",{children:i.name}),"? This action cannot be undone."]}):"Are you sure you want to delete this company? This action cannot be undone."})]}),l(K,{children:[l("div",{className:"md:flex pb-6 items-center",children:[a("h6",{className:"flex-1 md:mb-0 mb-3",children:v}),l("div",{className:"md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",children:[a("input",{type:"text",className:"form-control py-2",placeholder:"Search...",value:o,onChange:e=>E(e.target.value)}),a(g,{icon:"heroicons-outline:plus-sm",text:"Add Company",className:"btn-dark font-normal btn-sm",iconClass:"text-lg",onClick:()=>{m("/admin/companies/create")}})]})]}),_||S?a(U,{count:4}):P?l("div",{children:["Error fetching companies:"," ",((C=p==null?void 0:p.data)==null?void 0:C.message)||"Unknown error"]}):l(u,{children:[a("div",{className:"overflow-x-auto -mx-6",children:a("div",{className:"inline-block min-w-full align-middle",children:a("div",{className:"overflow-hidden",children:t&&t.data.length>0?l("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...B(),children:[a("thead",{className:"bg-slate-200 dark:bg-slate-700",children:L.map(e=>s.exports.createElement("tr",{...e.getHeaderGroupProps(),key:e.id},e.headers.map(n=>s.exports.createElement("th",{...n.getHeaderProps(n.getSortByToggleProps()),scope:"col",className:"table-th",key:n.id},n.render("Header"),a("span",{children:n.isSorted?n.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})))))}),a("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...j(),children:A.map(e=>(V(e),s.exports.createElement("tr",{...e.getRowProps(),key:e.id},e.cells.map(n=>s.exports.createElement("td",{...n.getCellProps(),className:"table-td",key:n.column.id},n.render("Cell"))))))})]}):l("div",{className:"text-center py-10",children:[a(r,{icon:"heroicons-outline:search",className:"inline-block text-4xl text-slate-400 mb-3"}),a("h3",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"No companies found"}),a("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:o?`No results found for "${o}"`:"No companies available in the database"})]})})})}),t&&t.data.length>0&&l("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[l("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[a("select",{className:"form-control py-2 w-max",value:d.perPage,onChange:e=>$(Number(e.target.value)),children:[10,25,50].map(e=>l("option",{value:e,children:["Show ",e]},e))}),l("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",l("span",{children:[t?t.current_page:0," ","of"," ",t?t.last_page:0]})]})]}),l("ul",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[a("li",{children:a("button",{className:t!=null&&t.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:I,disabled:!(t!=null&&t.prev_page_url),children:a(r,{icon:"heroicons:chevron-double-left-solid"})})}),a("li",{children:a("button",{className:t!=null&&t.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:R,disabled:!(t!=null&&t.prev_page_url),children:"Prev"})}),G(),a("li",{children:a("button",{className:t!=null&&t.next_page_url?"":"opacity-50 cursor-not-allowed",onClick:q,disabled:!(t!=null&&t.next_page_url),children:"Next"})}),a("li",{children:a("button",{onClick:Q,disabled:!(t!=null&&t.next_page_url),className:t!=null&&t.next_page_url?"":"opacity-50 cursor-not-allowed",children:a(r,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})]})]})}export{ne as default};
