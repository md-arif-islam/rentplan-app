import{S as Y}from"./Table.d473f6a6.js";import{r as n,d as Z,c as ee,m as w,j as s,a,I as o,F as g,B as f,C as ae,E as x,Q as S}from"./index.075fb68b.js";import{T as b,u as te,M as le}from"./useCustomTable.fbd3a482.js";import{u as se,a as ne}from"./usersApiSlice.1760b12c.js";function de({title:D="Team Members"}){var C;const[c,T]=n.exports.useState(""),[U,d]=n.exports.useState(!1),[m,N]=n.exports.useState({page:1,perPage:10,search:""}),h=Z(),u=ee(),v=w(e=>e.auth.user),{data:t,isLoading:E,isError:M,isFetching:H,error:p}=se(m),[F,{isLoading:j}]=ne(),B=e=>{T(e)},$=e=>{u(x(e)),d(!0)},y=()=>{d(!1),u(x(null))},i=w(e=>e.users.user),A=async()=>{var e;if(!!i)try{await F(i.id).unwrap(),S.success("User deleted successfully!"),d(!1),u(x(null))}catch(l){S.error(((e=l==null?void 0:l.data)==null?void 0:e.message)||"Failed to delete user"),console.error(l)}},L=n.exports.useMemo(()=>[{Header:"Name",accessor:e=>{var l,r;return((l=e.userProfile)==null?void 0:l.name)||((r=e.user_profile)==null?void 0:r.name)||"\u2014"},Cell:({cell:{value:e},row:l})=>{var r,k,_,P;return s("div",{className:"flex items-center",children:[a("div",{className:"h-10 w-10 rounded-full overflow-hidden mr-3",children:((r=l.original.userProfile)==null?void 0:r.avatar)||((k=l.original.user_profile)==null?void 0:k.avatar)?a("img",{src:`https://kolster-app.onlinewithyou.nl/${((_=l.original.userProfile)==null?void 0:_.avatar)||((P=l.original.user_profile)==null?void 0:P.avatar)}`,alt:e,className:"w-full h-full object-cover"}):a("div",{className:"flex items-center justify-center w-full h-full bg-slate-200 dark:bg-slate-700",children:a(o,{icon:"heroicons-outline:user"})})}),a("span",{children:e})]})}},{Header:"Email",accessor:"email",Cell:({cell:{value:e}})=>a("span",{children:e||"\u2014"})},{Header:"Role",accessor:"role.name",Cell:({cell:{value:e}})=>a("span",{className:"capitalize",children:(e==null?void 0:e.replace("_"," "))||"\u2014"})},{Header:"Phone",accessor:e=>{var l,r;return((l=e.userProfile)==null?void 0:l.phone)||((r=e.user_profile)==null?void 0:r.phone)||"\u2014"},Cell:({cell:{value:e}})=>a("span",{children:e})},{Header:"Action",accessor:"action",Cell:({row:e})=>s("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[a(b,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:a("button",{className:"action-btn",type:"button",onClick:()=>h(`/company/users/${e.original.id}`),children:a(o,{icon:"heroicons:eye"})})}),a(b,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:a("button",{className:"action-btn",type:"button",onClick:()=>h(`/company/users/${e.original.id}/edit`),children:a(o,{icon:"heroicons:pencil-square"})})}),v.id!==e.original.id&&a(b,{content:"Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:a("button",{className:"action-btn",type:"button",onClick:()=>$(e.original),children:a(o,{icon:"heroicons:trash"})})})]})}],[v]),V=()=>{var e,l;return i?((e=i.userProfile)==null?void 0:e.name)||((l=i.user_profile)==null?void 0:l.name)||i.email:""};n.exports.useEffect(()=>{const e=setTimeout(()=>{N(l=>({...l,page:1,search:c}))},500);return()=>clearTimeout(e)},[c]);const{getTableProps:R,getTableBodyProps:I,headerGroups:Q,page:q,prepareRow:G,handlePageSizeChange:z,handleFirst:J,handleLast:K,handlePrevious:O,handleNext:W,renderPaginationButtons:X}=te({dataVar:t,columns:L,pagination:m,setPagination:N});return s(g,{children:[s(le,{title:"Confirm Delete",labelClass:"btn-outline-danger",themeClass:"bg-danger-500",activeModal:U,onClose:y,centered:!0,footerContent:s("div",{className:"flex items-center gap-3",children:[a(f,{text:"Cancel",className:"btn-outline-dark",onClick:y}),a(f,{text:"Delete",className:"btn-danger",isLoading:j,onClick:A})]}),children:[a("h4",{className:"font-medium text-lg mb-3 text-slate-900",children:"Delete User"}),a("div",{className:"text-base text-slate-600 dark:text-slate-300",children:i?s(g,{children:["Are you sure you want to delete"," ",a("strong",{children:V()}),"? This action cannot be undone."]}):"Are you sure you want to delete this user? This action cannot be undone."})]}),s(ae,{children:[s("div",{className:"md:flex pb-6 items-center",children:[a("h6",{className:"flex-1 md:mb-0 mb-3",children:D}),s("div",{className:"md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",children:[a("input",{type:"text",className:"form-control py-2",placeholder:"Search...",value:c,onChange:e=>B(e.target.value)}),a(f,{icon:"heroicons-outline:plus-sm",text:"Add User",className:"btn-dark font-normal btn-sm",iconClass:"text-lg",onClick:()=>{h("/company/users/create")}})]})]}),E||H?a(Y,{count:4}):M?s("div",{children:["Error fetching users:"," ",((C=p==null?void 0:p.data)==null?void 0:C.message)||"Unknown error"]}):s(g,{children:[a("div",{className:"overflow-x-auto -mx-6",children:a("div",{className:"inline-block min-w-full align-middle",children:a("div",{className:"overflow-hidden",children:t&&t.data.length>0?s("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...R(),children:[a("thead",{className:"bg-slate-200 dark:bg-slate-700",children:Q.map(e=>n.exports.createElement("tr",{...e.getHeaderGroupProps(),key:e.id},e.headers.map(l=>n.exports.createElement("th",{...l.getHeaderProps(l.getSortByToggleProps()),scope:"col",className:"table-th",key:l.id},l.render("Header"),a("span",{children:l.isSorted?l.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})))))}),a("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...I(),children:q.map(e=>(G(e),n.exports.createElement("tr",{...e.getRowProps(),key:e.id},e.cells.map(l=>n.exports.createElement("td",{...l.getCellProps(),className:"table-td",key:l.column.id},l.render("Cell"))))))})]}):s("div",{className:"text-center py-10",children:[a(o,{icon:"heroicons-outline:search",className:"inline-block text-4xl text-slate-400 mb-3"}),a("h3",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"No users found"}),a("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:c?`No results found for "${c}"`:"No users available yet"})]})})})}),t&&t.data.length>0&&s("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[s("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[a("select",{className:"form-control py-2 w-max",value:m.perPage,onChange:e=>z(Number(e.target.value)),children:[10,25,50].map(e=>s("option",{value:e,children:["Show ",e]},e))}),s("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",s("span",{children:[t?t.current_page:0," of"," ",t?t.last_page:0]})]})]}),s("ul",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[a("li",{children:a("button",{className:t!=null&&t.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:J,disabled:!(t!=null&&t.prev_page_url),children:a(o,{icon:"heroicons:chevron-double-left-solid"})})}),a("li",{children:a("button",{className:t!=null&&t.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:O,disabled:!(t!=null&&t.prev_page_url),children:"Prev"})}),X(),a("li",{children:a("button",{className:t!=null&&t.next_page_url?"":"opacity-50 cursor-not-allowed",onClick:W,disabled:!(t!=null&&t.next_page_url),children:"Next"})}),a("li",{children:a("button",{onClick:K,disabled:!(t!=null&&t.next_page_url),className:t!=null&&t.next_page_url?"":"opacity-50 cursor-not-allowed",children:a(o,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})]})]})}export{de as default};
