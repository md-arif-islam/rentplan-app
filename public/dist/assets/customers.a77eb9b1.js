import{S as U}from"./Table.d473f6a6.js";import{r as n,d as J,c as K,m as O,a as t,j as l,I as r,F as p,B as g,C as W,H as x,Q as N}from"./index.075fb68b.js";import{T as b,u as X,M as Y}from"./useCustomTable.fbd3a482.js";import{u as Z,a as z}from"./customersApiSlice.4a4014f7.js";function se({title:v="Customers"}){var y;const[o,k]=n.exports.useState(""),[_,i]=n.exports.useState(!1),[d,f]=n.exports.useState({page:1,perPage:10,search:""}),m=J(),u=K(),{data:a,isLoading:w,isError:P,isFetching:S,error:h}=Z(d),[D,{isLoading:T}]=z(),H=e=>{k(e)},E=e=>{u(x(e)),i(!0)},C=()=>{i(!1),u(x(null))},c=O(e=>e.customers.customer),M=async()=>{var e;if(!!c)try{await D(c.id).unwrap(),N.success("Customer deleted successfully!"),i(!1),u(x(null))}catch(s){N.error(((e=s==null?void 0:s.data)==null?void 0:e.message)||"Failed to delete customer"),console.error(s)}},F=n.exports.useMemo(()=>[{Header:"Name",accessor:e=>`${e.first_name} ${e.last_name}`,Cell:({cell:{value:e}})=>t("span",{children:e})},{Header:"Email",accessor:"email",Cell:({cell:{value:e}})=>t("span",{children:e||"\u2014"})},{Header:"Phone",accessor:"phone",Cell:({cell:{value:e}})=>t("span",{children:e||"\u2014"})},{Header:"City",accessor:"city",Cell:({cell:{value:e}})=>t("span",{children:e||"\u2014"})},{Header:"Country",accessor:"country",Cell:({cell:{value:e}})=>t("span",{children:e||"\u2014"})},{Header:"Action",accessor:"action",Cell:({row:e})=>l("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[t(b,{content:"View",placement:"top",arrow:!0,animation:"shift-away",children:t("button",{className:"action-btn",type:"button",onClick:()=>m(`/company/customers/${e.original.id}`),children:t(r,{icon:"heroicons:eye"})})}),t(b,{content:"Edit",placement:"top",arrow:!0,animation:"shift-away",children:t("button",{className:"action-btn",type:"button",onClick:()=>m(`/company/customers/${e.original.id}/edit`),children:t(r,{icon:"heroicons:pencil-square"})})}),t(b,{content:"Delete",placement:"top",arrow:!0,animation:"shift-away",theme:"danger",children:t("button",{className:"action-btn",type:"button",onClick:()=>E(e.original),children:t(r,{icon:"heroicons:trash"})})})]})}],[]);n.exports.useEffect(()=>{const e=setTimeout(()=>{f(s=>({...s,page:1,search:o}))},500);return()=>clearTimeout(e)},[o]);const{getTableProps:B,getTableBodyProps:$,headerGroups:j,page:A,prepareRow:L,handlePageSizeChange:V,handleFirst:I,handleLast:Q,handlePrevious:R,handleNext:q,renderPaginationButtons:G}=X({dataVar:a,columns:F,pagination:d,setPagination:f});return l(p,{children:[l(Y,{title:"Confirm Delete",labelClass:"btn-outline-danger",themeClass:"bg-danger-500",activeModal:_,onClose:C,centered:!0,footerContent:l("div",{className:"flex items-center gap-3",children:[t(g,{text:"Cancel",className:"btn-outline-dark",onClick:C}),t(g,{text:"Delete",className:"btn-danger",isLoading:T,onClick:M})]}),children:[t("h4",{className:"font-medium text-lg mb-3 text-slate-900",children:"Delete Customer"}),t("div",{className:"text-base text-slate-600 dark:text-slate-300",children:c?l(p,{children:["Are you sure you want to delete"," ",l("strong",{children:[c.first_name," ",c.last_name]}),"? This action cannot be undone."]}):"Are you sure you want to delete this customer? This action cannot be undone."})]}),l(W,{children:[l("div",{className:"md:flex pb-6 items-center",children:[t("h6",{className:"flex-1 md:mb-0 mb-3",children:v}),l("div",{className:"md:flex md:space-x-3 items-center flex-none rtl:space-x-reverse",children:[t("input",{type:"text",className:"form-control py-2",placeholder:"Search...",value:o,onChange:e=>H(e.target.value)}),t(g,{icon:"heroicons-outline:plus-sm",text:"Add Customer",className:"btn-dark font-normal btn-sm",iconClass:"text-lg",onClick:()=>{m("/company/customers/create")}})]})]}),w||S?t(U,{count:4}):P?l("div",{children:["Error fetching customers:"," ",((y=h==null?void 0:h.data)==null?void 0:y.message)||"Unknown error"]}):l(p,{children:[t("div",{className:"overflow-x-auto -mx-6",children:t("div",{className:"inline-block min-w-full align-middle",children:t("div",{className:"overflow-hidden",children:a&&a.data.length>0?l("table",{className:"min-w-full divide-y divide-slate-100 table-fixed dark:divide-slate-700",...B(),children:[t("thead",{className:"bg-slate-200 dark:bg-slate-700",children:j.map(e=>n.exports.createElement("tr",{...e.getHeaderGroupProps(),key:e.id},e.headers.map(s=>n.exports.createElement("th",{...s.getHeaderProps(s.getSortByToggleProps()),scope:"col",className:"table-th",key:s.id},s.render("Header"),t("span",{children:s.isSorted?s.isSortedDesc?" \u{1F53D}":" \u{1F53C}":""})))))}),t("tbody",{className:"bg-white divide-y divide-slate-100 dark:bg-slate-800 dark:divide-slate-700",...$(),children:A.map(e=>(L(e),n.exports.createElement("tr",{...e.getRowProps(),key:e.id},e.cells.map(s=>n.exports.createElement("td",{...s.getCellProps(),className:"table-td",key:s.column.id},s.render("Cell"))))))})]}):l("div",{className:"text-center py-10",children:[t(r,{icon:"heroicons-outline:search",className:"inline-block text-4xl text-slate-400 mb-3"}),t("h3",{className:"text-lg font-medium text-slate-600 dark:text-slate-300",children:"No customers found"}),t("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:o?`No results found for "${o}"`:"No customers available yet"})]})})})}),a&&a.data.length>0&&l("div",{className:"md:flex md:space-y-0 space-y-5 justify-between mt-6 items-center",children:[l("div",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[t("select",{className:"form-control py-2 w-max",value:d.perPage,onChange:e=>V(Number(e.target.value)),children:[10,25,50].map(e=>l("option",{value:e,children:["Show ",e]},e))}),l("span",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:["Page"," ",l("span",{children:[a?a.current_page:0," ","of"," ",a?a.last_page:0]})]})]}),l("ul",{className:"flex items-center space-x-3 rtl:space-x-reverse",children:[t("li",{children:t("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:I,disabled:!(a!=null&&a.prev_page_url),children:t(r,{icon:"heroicons:chevron-double-left-solid"})})}),t("li",{children:t("button",{className:a!=null&&a.prev_page_url?"":"opacity-50 cursor-not-allowed",onClick:R,disabled:!(a!=null&&a.prev_page_url),children:"Prev"})}),G(),t("li",{children:t("button",{className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",onClick:q,disabled:!(a!=null&&a.next_page_url),children:"Next"})}),t("li",{children:t("button",{onClick:Q,disabled:!(a!=null&&a.next_page_url),className:a!=null&&a.next_page_url?"":"opacity-50 cursor-not-allowed",children:t(r,{icon:"heroicons:chevron-double-right-solid"})})})]})]})]})]})]})}export{se as default};
