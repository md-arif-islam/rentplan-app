import{d as U,r as B,j as n,a as e,B as d,C as p,I as D,Q as E}from"./index.075fb68b.js";import{S as O}from"./Select.3e0ab40e.js";import{T as r}from"./Textinput.595cc28f.js";import{c as T}from"./companiesApiSlice.7aa8620f.js";import{c as w,a as l,d as $,e as P,b as G,u as M,o as z}from"./array.537130ac.js";const V=w().shape({name:l().required("Company name is required").max(255,"Company name cannot exceed 255 characters"),email:l().required("Email is required").email("Please enter a valid email address").max(255,"Email cannot exceed 255 characters"),phone:l().max(20,"Phone cannot exceed 20 characters"),website:l().url("Please enter a valid URL").max(255,"Website URL cannot exceed 255 characters").nullable(),address_line_1:l().max(255,"Address cannot exceed 255 characters").nullable(),address_line_2:l().max(255,"Address cannot exceed 255 characters").nullable(),city:l().max(255,"City cannot exceed 255 characters").nullable(),state:l().max(255,"State cannot exceed 255 characters").nullable(),postal_code:l().max(20,"Postal code cannot exceed 20 characters").nullable(),country:l().max(255,"Country cannot exceed 255 characters").nullable(),plan:w().shape({plan_name:l().required("Plan name is required"),plan_price:$().required("Plan price is required").min(0,"Price cannot be negative"),plan_status:l().required("Plan status is required").oneOf(["active","inactive","trial","expired"],"Invalid plan status"),plan_start_date:P().required("Start date is required"),plan_expiry_date:P().required("Expiry date is required").min(G("plan_start_date"),"Expiry date must be after start date")})}),X=()=>{var g,f,v,C,N;const m=U(),u=B.exports.useRef(null),[S,{isLoading:x}]=T(),{register:t,handleSubmit:q,formState:{errors:a,isSubmitting:h},setError:k,setValue:y,watch:b}=M({resolver:z(V),mode:"onChange",defaultValues:{name:"",email:"",phone:"",website:"",address_line_1:"",address_line_2:"",city:"",state:"",postal_code:"",country:"",logo:null,plan:{plan_name:"Basic",plan_price:0,plan_status:"active",plan_features:["basic_features"],plan_start_date:new Date().toISOString().split("T")[0],plan_expiry_date:new Date().toISOString().split("T")[0]}}}),I=async c=>{const o=c.target.files[0];if(o){const i=new FileReader;i.onloadend=()=>{y("logo",i.result)},i.readAsDataURL(o)}},L=()=>{u.current.click()},j=async c=>{var o,i;try{await S(c).unwrap(),E.success("Company created successfully"),m("/admin/companies")}catch(s){console.error("Create failed",s),(o=s==null?void 0:s.data)!=null&&o.errors?Object.entries(s.data.errors).forEach(([R,F])=>{k(R,{type:"manual",message:F[0]})}):E.error(((i=s==null?void 0:s.data)==null?void 0:i.message)||"Failed to create company")}},_=b("logo"),A=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"trial",label:"Trial"},{value:"expired",label:"Expired"}];return n("div",{className:"space-y-5",children:[n("div",{className:"flex flex-wrap justify-between items-center",children:[e("h4",{className:"font-medium lg:text-2xl text-xl capitalize text-slate-900 inline-block ltr:pr-4 rtl:pl-4",children:"Create New Company"}),e(d,{icon:"heroicons-outline:arrow-left",text:"Back",className:"btn-outline-dark",onClick:()=>m("/admin/companies")})]}),n("form",{onSubmit:q(j),children:[e(p,{title:"Company Information",children:n("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(r,{label:"Company Name *",type:"text",placeholder:"Enter company name",register:t,name:"name",error:a.name}),e(r,{label:"Email *",type:"email",placeholder:"Enter company email",register:t,name:"email",error:a.email}),e(r,{label:"Phone",type:"text",placeholder:"Enter phone number",register:t,name:"phone",error:a.phone}),e(r,{label:"Website",type:"url",placeholder:"Enter website URL",register:t,name:"website",error:a.website})]})}),e(p,{title:"Address Information",className:"mt-5",children:n("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(r,{label:"Address Line 1",type:"text",placeholder:"Enter address line 1",register:t,name:"address_line_1",error:a.address_line_1}),e(r,{label:"Address Line 2",type:"text",placeholder:"Enter address line 2",register:t,name:"address_line_2",error:a.address_line_2}),e(r,{label:"City",type:"text",placeholder:"Enter city",register:t,name:"city",error:a.city}),e(r,{label:"State/Province",type:"text",placeholder:"Enter state or province",register:t,name:"state",error:a.state}),e(r,{label:"Postal Code",type:"text",placeholder:"Enter postal code",register:t,name:"postal_code",error:a.postal_code}),e(r,{label:"Country",type:"text",placeholder:"Enter country",register:t,name:"country",error:a.country})]})}),e(p,{title:"Company Logo",className:"mt-5",children:n("div",{className:"flex items-start space-x-4 rtl:space-x-reverse",children:[e("div",{children:_?e("img",{src:_,alt:"Logo Preview",className:"h-20 w-20 object-contain border border-slate-200 rounded-lg bg-slate-50"}):e("div",{className:"h-20 w-20 rounded-lg bg-slate-100 flex items-center justify-center",children:e(D,{icon:"heroicons-outline:office-building",className:"text-3xl text-slate-400"})})}),n("div",{className:"flex-1",children:[e(d,{text:"Upload Logo",icon:"heroicons-outline:upload",className:"btn-outline-dark",onClick:L}),e("input",{type:"file",ref:u,className:"hidden",accept:"image/*",onChange:I}),e("p",{className:"text-xs text-slate-500 mt-2",children:"Supported formats: JPG, PNG, GIF (Max size: 2MB)"})]})]})}),e(p,{title:"Plan Information",className:"mt-5",children:n("div",{className:"grid lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-5",children:[e(r,{label:"Plan Name",type:"text",placeholder:"Enter plan name",register:t,name:"plan.plan_name",error:(g=a.plan)==null?void 0:g.plan_name}),e(r,{label:"Price",type:"number",placeholder:"Enter price",register:t,name:"plan.plan_price",step:"0.01",min:"0",error:(f=a.plan)==null?void 0:f.plan_price}),e(O,{label:"Status",options:A,value:b("plan.plan_status"),onChange:c=>y("plan.plan_status",c.target.value),error:(v=a.plan)==null?void 0:v.plan_status}),e(r,{label:"Start Date",type:"date",register:t,name:"plan.plan_start_date",error:(C=a.plan)==null?void 0:C.plan_start_date}),e(r,{label:"Expiry Date",type:"date",register:t,name:"plan.plan_expiry_date",error:(N=a.plan)==null?void 0:N.plan_expiry_date})]})}),n("div",{className:"flex justify-between items-center mt-5",children:[e(d,{type:"button",icon:"heroicons-outline:x",text:"Cancel",className:"btn-outline-dark",onClick:()=>m("/admin/companies")}),e(d,{type:"submit",icon:"heroicons-outline:plus",text:"Create Company",className:"btn-dark",isLoading:x||h,disabled:x||h})]})]})]})};export{X as default};
