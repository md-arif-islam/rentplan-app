import{d as j,r as S,j as r,a as e,B as c,C as u,I as q,Q as w}from"./index.075fb68b.js";import{T as i}from"./Textinput.595cc28f.js";import{c as F}from"./usersApiSlice.1760b12c.js";import{c as _,a as n,b as I,u as B,o as R}from"./array.537130ac.js";const G=_().shape({email:n().required("Email is required").email("Please enter a valid email address").max(255,"Email cannot exceed 255 characters"),password:n().required("Password is required").min(8,"Password must be at least 8 characters"),password_confirmation:n().required("Please confirm your password").oneOf([I("password"),null],"Passwords must match"),name:n().required("Name is required").max(255,"Name cannot exceed 255 characters"),phone:n().nullable().max(20,"Phone number cannot exceed 20 characters")}),A=()=>{const d=j(),p=S.exports.useRef(null),[b,{isLoading:h}]=F(),{register:t,handleSubmit:g,formState:{errors:l,isSubmitting:f},setError:N,setValue:y,watch:v}=B({resolver:R(G),mode:"onChange",defaultValues:{email:"",password:"",password_confirmation:"",name:"",phone:"",avatar:null}}),C=async m=>{const o=m.target.files[0];if(o){const s=new FileReader;s.onloadend=()=>{y("avatar",s.result)},s.readAsDataURL(o)}},P=()=>{p.current.click()},k=async m=>{var o,s;try{const a={...m,role_id:"company_admin"};await b(a).unwrap(),w.success("User created successfully"),d("/company/users")}catch(a){console.error("Create failed",a),(o=a==null?void 0:a.data)!=null&&o.errors?Object.entries(a.data.errors).forEach(([U,E])=>{N(U,{type:"manual",message:E[0]})}):w.error(((s=a==null?void 0:a.data)==null?void 0:s.message)||"Failed to create user")}},x=v("avatar");return r("div",{className:"space-y-5",children:[r("div",{className:"flex flex-wrap justify-between items-center",children:[e("h4",{className:"font-medium lg:text-2xl text-xl capitalize text-slate-900 inline-block ltr:pr-4 rtl:pl-4",children:"Create New User"}),e(c,{icon:"heroicons-outline:arrow-left",text:"Back",className:"btn-outline-dark",onClick:()=>d("/company/users")})]}),r("form",{onSubmit:g(k),children:[e(u,{title:"User Information",children:r("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(i,{label:"Full Name *",type:"text",placeholder:"Enter full name",register:t,name:"name",error:l.name}),e(i,{label:"Email *",type:"email",placeholder:"Enter email address",register:t,name:"email",error:l.email}),e(i,{label:"Phone",type:"text",placeholder:"Enter phone number",register:t,name:"phone",error:l.phone})]})}),e(u,{title:"Security",className:"mt-5",children:r("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(i,{label:"Password *",type:"password",placeholder:"Enter password",register:t,name:"password",error:l.password}),e(i,{label:"Confirm Password *",type:"password",placeholder:"Confirm password",register:t,name:"password_confirmation",error:l.password_confirmation})]})}),e(u,{title:"Profile Picture",className:"mt-5",children:r("div",{className:"flex items-start space-x-4 rtl:space-x-reverse",children:[e("div",{children:x?e("img",{src:x,alt:"Avatar Preview",className:"h-20 w-20 rounded-full object-cover"}):e("div",{className:"h-20 w-20 rounded-full bg-slate-200 flex items-center justify-center",children:e(q,{icon:"heroicons-outline:user",className:"text-3xl text-slate-400"})})}),r("div",{className:"flex-1",children:[e(c,{text:"Upload Picture",icon:"heroicons-outline:upload",className:"btn-outline-dark",onClick:P}),e("input",{type:"file",ref:p,className:"hidden",accept:"image/*",onChange:C}),e("p",{className:"text-xs text-slate-500 mt-2",children:"Supported formats: JPG, PNG, GIF (Max size: 2MB)"})]})]})}),r("div",{className:"flex justify-between items-center mt-5",children:[e(c,{type:"button",icon:"heroicons-outline:x",text:"Cancel",className:"btn-outline-dark",onClick:()=>d("/company/users")}),e(c,{type:"submit",icon:"heroicons-outline:plus",text:"Create User",className:"btn-dark",isLoading:h||f,disabled:h||f})]})]})]})};export{A as default};
