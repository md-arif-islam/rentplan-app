import{q as L,d as D,r as P,a as e,y as j,C as d,j as c,I as q,B as m,Q as _}from"./index.075fb68b.js";import{T as o}from"./Textinput.595cc28f.js";import{b as B,d as F}from"./customersApiSlice.4a4014f7.js";import{c as U,a as n,e as $,d as T,u as W,o as H}from"./array.537130ac.js";const O=U().shape({first_name:n().required("First name is required").max(255,"First name cannot exceed 255 characters"),last_name:n().required("Last name is required").max(255,"Last name cannot exceed 255 characters"),email:n().email("Please enter a valid email address").nullable().max(255,"Email cannot exceed 255 characters"),phone:n().nullable().max(50,"Phone cannot exceed 50 characters"),street:n().nullable().max(255,"Street cannot exceed 255 characters"),house_number:n().nullable().max(50,"House number cannot exceed 50 characters"),postal_code:n().nullable().max(20,"Postal code cannot exceed 20 characters"),city:n().nullable().max(100,"City cannot exceed 100 characters"),country:n().nullable().max(100,"Country cannot exceed 100 characters"),date_of_birth:$().nullable().typeError("Please enter a valid date").transform(s=>s?new Date(s):null),woocommerce_customer_id:T().nullable().integer("WooCommerce ID must be an integer").transform(s=>isNaN(s)?null:s)}),M=()=>{var b;const{id:s}=L(),i=D(),{data:t,isLoading:g,isError:C,error:u}=B(s),[N,{isLoading:h}]=F(),{register:a,handleSubmit:E,formState:{errors:r,isSubmitting:p},setError:w,reset:x}=W({resolver:H(O),mode:"onChange"});P.exports.useEffect(()=>{t&&x({first_name:t.first_name||"",last_name:t.last_name||"",email:t.email||"",phone:t.phone||"",street:t.street||"",house_number:t.house_number||"",postal_code:t.postal_code||"",city:t.city||"",country:t.country||"",date_of_birth:t.date_of_birth?new Date(t.date_of_birth).toISOString().split("T")[0]:null,woocommerce_customer_id:t.woocommerce_customer_id||null})},[t,x]);const v=async k=>{var f,y;try{await N({id:s,...k}).unwrap(),_.success("Customer updated successfully"),i("/company/customers")}catch(l){console.error("Update failed",l),(f=l==null?void 0:l.data)!=null&&f.errors?Object.entries(l.data.errors).forEach(([I,S])=>{w(I,{type:"manual",message:S[0]})}):_.error(((y=l==null?void 0:l.data)==null?void 0:y.message)||"Failed to update customer")}};return g?e(j,{}):C?e(d,{children:c("div",{className:"flex flex-col items-center justify-center h-60",children:[e(q,{icon:"heroicons-outline:exclamation-circle",className:"text-danger-500 text-4xl mb-2"}),e("h3",{className:"text-xl font-medium text-slate-900",children:"Error Loading Data"}),e("p",{className:"text-sm text-slate-600 mt-1 mb-4",children:((b=u==null?void 0:u.data)==null?void 0:b.message)||"Could not load customer information"}),e(m,{text:"Back to Customers",icon:"heroicons-outline:arrow-left",className:"btn-primary",onClick:()=>i("/company/customers")})]})}):c("div",{className:"space-y-5",children:[c("div",{className:"flex flex-wrap justify-between items-center",children:[e("h4",{className:"font-medium lg:text-2xl text-xl capitalize text-slate-900 inline-block ltr:pr-4 rtl:pl-4",children:"Edit Customer"}),c("div",{className:"flex space-x-3 rtl:space-x-reverse",children:[e(m,{icon:"heroicons-outline:arrow-left",text:"Back",className:"btn-outline-dark",onClick:()=>i("/company/customers")}),e(m,{icon:"heroicons-outline:eye",text:"View Details",className:"btn-outline-dark",onClick:()=>i(`/company/customers/${s}`)})]})]}),c("form",{onSubmit:E(v),children:[e(d,{title:"Personal Information",children:c("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(o,{label:"First Name *",type:"text",placeholder:"Enter first name",register:a,name:"first_name",error:r.first_name}),e(o,{label:"Last Name *",type:"text",placeholder:"Enter last name",register:a,name:"last_name",error:r.last_name}),e(o,{label:"Email",type:"email",placeholder:"Enter email address",register:a,name:"email",error:r.email}),e(o,{label:"Phone",type:"text",placeholder:"Enter phone number",register:a,name:"phone",error:r.phone}),e(o,{label:"Date of Birth",type:"date",placeholder:"Select date of birth",register:a,name:"date_of_birth",error:r.date_of_birth})]})}),e(d,{title:"Address Information",className:"mt-5",children:c("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:[e(o,{label:"Street",type:"text",placeholder:"Enter street name",register:a,name:"street",error:r.street}),e(o,{label:"House Number",type:"text",placeholder:"Enter house number",register:a,name:"house_number",error:r.house_number}),e(o,{label:"Postal Code",type:"text",placeholder:"Enter postal code",register:a,name:"postal_code",error:r.postal_code}),e(o,{label:"City",type:"text",placeholder:"Enter city",register:a,name:"city",error:r.city}),e(o,{label:"Country",type:"text",placeholder:"Enter country",register:a,name:"country",error:r.country})]})}),e(d,{title:"Integration Information",className:"mt-5",children:e("div",{className:"grid lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-5",children:e(o,{label:"WooCommerce Customer ID",type:"number",placeholder:"Enter WooCommerce ID (optional)",register:a,name:"woocommerce_customer_id",error:r.woocommerce_customer_id})})}),c("div",{className:"flex justify-between items-center mt-5",children:[e(m,{type:"button",icon:"heroicons-outline:x",text:"Cancel",className:"btn-outline-dark",onClick:()=>i("/company/customers")}),e(m,{type:"submit",icon:"heroicons-outline:save",text:"Update Customer",className:"btn-dark",isLoading:h||p,disabled:h||p})]})]})]})};export{M as default};
